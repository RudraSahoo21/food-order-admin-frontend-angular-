<div class="card shadow-sm">
  <div class="card-body">
    <h4 class="card-title">ðŸ›’ Product Table</h4>
    <div class="d-flex align-items-center gap-2">
      <input
        type="text"
        class="form-control"
        placeholder="Search product name"
        #searchInput
        style="max-width: 300px"
        [value]
      />
      <button
        type="submit"
        class="btn btn-primary"
        (click)="searchProdDtl(searchInput.value)"
        title="Search Product"
      >
        <i class="bi bi-search"></i>
      </button>
      <button
        type="button"
        class="btn btn-warning"
        (click)="resetTable()"
        title="Reset Table"
      >
        <i class="bi bi-arrow-repeat"></i>
      </button>
    </div>
    <div class="table-responsive">
      <table class="table table-bordered table-hover mt-3">
        <thead class="table-dark text-white">
          <tr>
            <th>#</th>
            <th>Image</th>
            <th>Product Name</th>
            <th>Product Type</th>
            <th>Available Stock</th>
            <th>Mrp</th>
            <th>PackageingCost</th>
            <th>PurchaseCost</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of pagedProducts; let i = index">
            <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
            <!-- Index of the product -->
            <td>
              <img
                *ngFor="let img of product.images"
                [src]="getImageUrl(img)"
                alt="Product Image"
                width="50"
                height="50"
              />
            </td>
            <td>{{ product.productName }}</td>
            <td>{{ product.productType }}</td>
            <td>{{ product.Available_Stock }}</td>
            <td>
              {{
                product.mrp !== null && product.mrp !== undefined
                  ? (product.mrp | currency : "INR")
                  : (0 | currency : "INR")
              }}
            </td>
            <td>{{ product.packageingCharge | currency : "INR" }}</td>
            <td>{{ product.purchaseCost | currency : "INR" }}</td>
            <td>
              <button
                type="button"
                class="btn btn-primary"
                (click)="edit(product.productId)"
                title="Edit Product"
              >
                <i class="bi bi-pencil-square"></i>
              </button>
              &nbsp;
              <button
                type="button"
                class="btn btn-danger"
                (click)="
                  openDeleteModal(product.productName, product.productId)
                "
                title="Remove Product"
              >
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <nav *ngIf="totalItems > pageSize" class="mt-3">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <a class="page-link" (click)="changePage(currentPage - 1)"
            >Previous</a
          >
        </li>

        <li
          class="page-item"
          *ngFor="let page of totalPages"
          [class.active]="currentPage === page"
        >
          <a class="page-link" (click)="changePage(page)">
            {{ page }}
          </a>
        </li>

        <li
          class="page-item"
          [class.disabled]="currentPage === totalPages.length"
        >
          <a class="page-link" (click)="changePage(currentPage + 1)">Next</a>
        </li>
      </ul>
    </nav>
  </div>
</div>

<!-- Delete Modal -->
<div class="modal-overlay" *ngIf="isDeleteModalOpen">
  <div class="modal-content">
    <div class="modal-header">
      <h1 class="modal-title fs-5" id="exampleModalLabel">
        Delete Product Details
      </h1>
      <button
        type="button"
        class="btn-close"
        aria-label="Close"
        (click)="closeDeleteModal()"
      ></button>
    </div>
    <div class="modal-body">
      Are you sure want to delete details of :
      <span id="pName"> {{ selectedProductName }} </span> ?
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="closeDeleteModal()"
      >
        No
      </button>
      <button type="button" class="btn btn-primary" (click)="removeprodDtl()">
        Yes
      </button>
    </div>
  </div>
</div>
